{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/runner/work/galadmin/galadmin/src/front/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import axios from\"axios\";import evalExpression from\"../utils/evalExpression\";import{jsx as _jsx}from\"react/jsx-runtime\";export default(function(_ref){var record=_ref.record,panel=_ref.panel;var downloadTable=function downloadTable(){axios.get(\"/customQuery\",{params:{query:panel.query||evalExpression(panel.formattedQuery,record),primaryValue:2630}}).then(function(response){var results=response.data;var lines=[];lines.push(Object.keys(results[0]).filter(function(key){return key!==panel.primaryId;}).join(\",\"));var _iterator=_createForOfIteratorHelper(results),_step;try{var _loop=function _loop(){var result=_step.value;lines.push(Object.keys(result).filter(function(key){return key!==panel.primaryId;}).map(function(key){return panel.formattedValues&&key in panel.formattedValues?evalExpression(panel.formattedValues[key],result):result[key];}).join(\",\"));};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}window.download(lines.join(\"\\r\\n\"),panel.label+\".csv\");});};return/*#__PURE__*/_jsx(\"div\",{class:\"downloadPanelButton\",onClick:downloadTable,children:/*#__PURE__*/_jsx(\"i\",{class:\"fa fa-cloud-download\"})});});","map":{"version":3,"names":["axios","evalExpression","jsx","_jsx","_ref","record","panel","downloadTable","get","params","query","formattedQuery","primaryValue","then","response","results","data","lines","push","Object","keys","filter","key","primaryId","join","_iterator","_createForOfIteratorHelper","_step","_loop","result","value","map","formattedValues","s","n","done","err","e","f","window","download","label","class","onClick","children"],"sources":["/home/runner/work/galadmin/galadmin/src/front/src/components/DownloadTablePanelButton.js"],"sourcesContent":["import axios from \"axios\";\nimport evalExpression from \"../utils/evalExpression\";\n\nexport default ({ record, panel }) => {\n    const downloadTable = () => {\n        axios.get(\"/customQuery\", {\n            params: {\n                query: panel.query || evalExpression(panel.formattedQuery, record),\n                primaryValue: 2630\n            }\n        }).then((response) => {\n            const results = response.data;\n            const lines = [];\n            lines.push(Object.keys(results[0]).filter(key => key !== panel.primaryId).join(\",\"))\n            for (let result of results) {\n                lines.push(\n                    Object.keys(result).filter(key => key !== panel.primaryId).map((key) =>\n                        (panel.formattedValues && (key in panel.formattedValues)) ? evalExpression(panel.formattedValues[key], result) : result[key]\n                    ).join(\",\")\n                )\n            }\n\n            window.download(lines.join(\"\\r\\n\"), panel.label + \".csv\");\n        })\n    }\n\n    return (<div class='downloadPanelButton' onClick={downloadTable}><i class='fa fa-cloud-download'></i></div>)\n}"],"mappings":"2JAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,cAAc,KAAM,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAErD,eAAe,SAAAC,IAAA,CAAuB,IAApB,CAAAC,MAAM,CAAAD,IAAA,CAANC,MAAM,CAAEC,KAAK,CAAAF,IAAA,CAALE,KAAK,CAC3B,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAA,CAAS,CACxBP,KAAK,CAACQ,GAAG,CAAC,cAAc,CAAE,CACtBC,MAAM,CAAE,CACJC,KAAK,CAAEJ,KAAK,CAACI,KAAK,EAAIT,cAAc,CAACK,KAAK,CAACK,cAAc,CAAEN,MAAM,CAAC,CAClEO,YAAY,CAAE,IAClB,CACJ,CAAC,CAAC,CAACC,IAAI,CAAC,SAACC,QAAQ,CAAK,CAClB,GAAM,CAAAC,OAAO,CAAGD,QAAQ,CAACE,IAAI,CAC7B,GAAM,CAAAC,KAAK,CAAG,EAAE,CAChBA,KAAK,CAACC,IAAI,CAACC,MAAM,CAACC,IAAI,CAACL,OAAO,CAAC,CAAC,CAAC,CAAC,CAACM,MAAM,CAAC,SAAAC,GAAG,QAAI,CAAAA,GAAG,GAAKhB,KAAK,CAACiB,SAAS,GAAC,CAACC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAAC,SAAA,CAAAC,0BAAA,CACjEX,OAAO,EAAAY,KAAA,SAAAC,KAAA,UAAAA,MAAA,CAAE,IAAnB,CAAAC,MAAM,CAAAF,KAAA,CAAAG,KAAA,CACXb,KAAK,CAACC,IAAI,CACNC,MAAM,CAACC,IAAI,CAACS,MAAM,CAAC,CAACR,MAAM,CAAC,SAAAC,GAAG,QAAI,CAAAA,GAAG,GAAKhB,KAAK,CAACiB,SAAS,GAAC,CAACQ,GAAG,CAAC,SAACT,GAAG,QAC9D,CAAAhB,KAAK,CAAC0B,eAAe,EAAKV,GAAG,GAAI,CAAAhB,KAAK,CAAC0B,eAAgB,CAAI/B,cAAc,CAACK,KAAK,CAAC0B,eAAe,CAACV,GAAG,CAAC,CAAEO,MAAM,CAAC,CAAGA,MAAM,CAACP,GAAG,CAAC,EAChI,CAAC,CAACE,IAAI,CAAC,GAAG,CACd,CAAC,CACL,CAAC,CAND,IAAAC,SAAA,CAAAQ,CAAA,KAAAN,KAAA,CAAAF,SAAA,CAAAS,CAAA,IAAAC,IAAA,GAAAP,KAAA,IAMC,OAAAQ,GAAA,EAAAX,SAAA,CAAAY,CAAA,CAAAD,GAAA,WAAAX,SAAA,CAAAa,CAAA,IAEDC,MAAM,CAACC,QAAQ,CAACvB,KAAK,CAACO,IAAI,CAAC,MAAM,CAAC,CAAElB,KAAK,CAACmC,KAAK,CAAG,MAAM,CAAC,CAC7D,CAAC,CAAC,CACN,CAAC,CAED,mBAAQtC,IAAA,QAAKuC,KAAK,CAAC,qBAAqB,CAACC,OAAO,CAAEpC,aAAc,CAAAqC,QAAA,cAACzC,IAAA,MAAGuC,KAAK,CAAC,sBAAsB,CAAI,CAAC,CAAK,CAAC,CAC/G,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}