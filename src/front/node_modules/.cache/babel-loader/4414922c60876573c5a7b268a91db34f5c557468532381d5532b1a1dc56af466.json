{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/galadmin/galadmin/src/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default(function(_ref){var _view$importFileTypes,_view$importFileTypes2;var view=_ref.view,viewIndex=_ref.viewIndex,refreshData=_ref.refreshData;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isUploading=_useState2[0],setIsUploading=_useState2[1];var uploadFileInputRef=useRef(null);var selectUploadFile=function selectUploadFile(){var _uploadFileInputRef$c;(_uploadFileInputRef$c=uploadFileInputRef.current)===null||_uploadFileInputRef$c===void 0?void 0:_uploadFileInputRef$c.click();};var uploadRecords=function uploadRecords(evt){setIsUploading(true);var formData=new FormData();formData.append(\"viewIndex\",viewIndex);formData.append(\"data\",evt.currentTarget.files[0]);axios.post(\"/recordsImport\",formData,{headers:{'Content-Type':'multipart/form-data'}}).then(function(){refreshData();window.swal({title:\"Succès\",text:\"Les données ont été importées avec succès\"});}).catch(function(error){window.swal({title:\"Erreur\",text:axios.isAxiosError(error)?error.response.data.message:\"Une erreur est survenue\",dangerMode:true});}).finally(function(){uploadFileInputRef.current.value=\"\";setIsUploading(false);});};return/*#__PURE__*/_jsxs(\"div\",{class:\"uploadButton\",onClick:selectUploadFile,children:[/*#__PURE__*/_jsx(\"i\",{class:\"fa \".concat(!isUploading?\"fa-cloud-upload\":\"fa-spin fa-circle-notch\")}),/*#__PURE__*/_jsx(\"input\",{ref:uploadFileInputRef,id:\"upload-file\",type:\"file\",accept:(_view$importFileTypes=(_view$importFileTypes2=view.importFileTypes)===null||_view$importFileTypes2===void 0?void 0:_view$importFileTypes2.join(\",\"))!==null&&_view$importFileTypes!==void 0?_view$importFileTypes:undefined,hidden:true,onChange:uploadRecords})]});});","map":{"version":3,"names":["useState","useRef","axios","jsx","_jsx","jsxs","_jsxs","_ref","_view$importFileTypes","_view$importFileTypes2","view","viewIndex","refreshData","_useState","_useState2","_slicedToArray","isUploading","setIsUploading","uploadFileInputRef","selectUploadFile","_uploadFileInputRef$c","current","click","uploadRecords","evt","formData","FormData","append","currentTarget","files","post","headers","then","window","swal","title","text","catch","error","isAxiosError","response","data","message","dangerMode","finally","value","class","onClick","children","concat","ref","id","type","accept","importFileTypes","join","undefined","hidden","onChange"],"sources":["/home/runner/work/galadmin/galadmin/src/front/src/components/UploadButton.js"],"sourcesContent":["\nimport { useState, useRef } from \"react\"\nimport axios from \"axios\";\n\nexport default ({ view, viewIndex, refreshData }) => {\n  const [isUploading, setIsUploading] = useState(false)\n\n  const uploadFileInputRef = useRef(null)\n\n  const selectUploadFile = () => {\n    uploadFileInputRef.current?.click()\n  }\n\n  const uploadRecords = (evt) => {\n    setIsUploading(true)\n\n    const formData = new FormData();\n    formData.append(\"viewIndex\", viewIndex)\n    formData.append(\"data\", evt.currentTarget.files[0])\n    axios.post(\"/recordsImport\", formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    }).then(() => {\n      refreshData()\n      window.swal({\n        title: \"Succès\",\n        text: \"Les données ont été importées avec succès\"\n      })\n    }).catch((error) => {\n      window.swal({\n        title: \"Erreur\",\n        text: axios.isAxiosError(error) ? error.response.data.message : \"Une erreur est survenue\",\n        dangerMode: true\n      })\n    }).finally(() => {\n      uploadFileInputRef.current.value = \"\"\n      setIsUploading(false)\n    })\n  }\n\n  return (\n    <div class=\"uploadButton\" onClick={selectUploadFile}>\n      <i class={`fa ${!isUploading ? \"fa-cloud-upload\" : \"fa-spin fa-circle-notch\"}`}></i>\n      <input\n        ref={uploadFileInputRef}\n        id=\"upload-file\"\n        type=\"file\"\n        accept={view.importFileTypes?.join(\",\") ?? undefined}\n        hidden\n        onChange={uploadRecords}\n      />\n    </div>\n  )\n}"],"mappings":"mIACA,OAASA,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CACxC,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE1B,eAAe,SAAAC,IAAA,CAAsC,KAAAC,qBAAA,CAAAC,sBAAA,IAAnC,CAAAC,IAAI,CAAAH,IAAA,CAAJG,IAAI,CAAEC,SAAS,CAAAJ,IAAA,CAATI,SAAS,CAAEC,WAAW,CAAAL,IAAA,CAAXK,WAAW,CAC5C,IAAAC,SAAA,CAAsCb,QAAQ,CAAC,KAAK,CAAC,CAAAc,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA9CG,WAAW,CAAAF,UAAA,IAAEG,cAAc,CAAAH,UAAA,IAElC,GAAM,CAAAI,kBAAkB,CAAGjB,MAAM,CAAC,IAAI,CAAC,CAEvC,GAAM,CAAAkB,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,KAAAC,qBAAA,CAC7B,CAAAA,qBAAA,CAAAF,kBAAkB,CAACG,OAAO,UAAAD,qBAAA,iBAA1BA,qBAAA,CAA4BE,KAAK,CAAC,CAAC,CACrC,CAAC,CAED,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAIC,GAAG,CAAK,CAC7BP,cAAc,CAAC,IAAI,CAAC,CAEpB,GAAM,CAAAQ,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,WAAW,CAAEhB,SAAS,CAAC,CACvCc,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEH,GAAG,CAACI,aAAa,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CACnD3B,KAAK,CAAC4B,IAAI,CAAC,gBAAgB,CAAEL,QAAQ,CAAE,CACrCM,OAAO,CAAE,CACP,cAAc,CAAE,qBAClB,CACF,CAAC,CAAC,CAACC,IAAI,CAAC,UAAM,CACZpB,WAAW,CAAC,CAAC,CACbqB,MAAM,CAACC,IAAI,CAAC,CACVC,KAAK,CAAE,QAAQ,CACfC,IAAI,CAAE,2CACR,CAAC,CAAC,CACJ,CAAC,CAAC,CAACC,KAAK,CAAC,SAACC,KAAK,CAAK,CAClBL,MAAM,CAACC,IAAI,CAAC,CACVC,KAAK,CAAE,QAAQ,CACfC,IAAI,CAAElC,KAAK,CAACqC,YAAY,CAACD,KAAK,CAAC,CAAGA,KAAK,CAACE,QAAQ,CAACC,IAAI,CAACC,OAAO,CAAG,yBAAyB,CACzFC,UAAU,CAAE,IACd,CAAC,CAAC,CACJ,CAAC,CAAC,CAACC,OAAO,CAAC,UAAM,CACf1B,kBAAkB,CAACG,OAAO,CAACwB,KAAK,CAAG,EAAE,CACrC5B,cAAc,CAAC,KAAK,CAAC,CACvB,CAAC,CAAC,CACJ,CAAC,CAED,mBACEX,KAAA,QAAKwC,KAAK,CAAC,cAAc,CAACC,OAAO,CAAE5B,gBAAiB,CAAA6B,QAAA,eAClD5C,IAAA,MAAG0C,KAAK,OAAAG,MAAA,CAAQ,CAACjC,WAAW,CAAG,iBAAiB,CAAG,yBAAyB,CAAG,CAAI,CAAC,cACpFZ,IAAA,UACE8C,GAAG,CAAEhC,kBAAmB,CACxBiC,EAAE,CAAC,aAAa,CAChBC,IAAI,CAAC,MAAM,CACXC,MAAM,EAAA7C,qBAAA,EAAAC,sBAAA,CAAEC,IAAI,CAAC4C,eAAe,UAAA7C,sBAAA,iBAApBA,sBAAA,CAAsB8C,IAAI,CAAC,GAAG,CAAC,UAAA/C,qBAAA,UAAAA,qBAAA,CAAIgD,SAAU,CACrDC,MAAM,MACNC,QAAQ,CAAEnC,aAAc,CACzB,CAAC,EACC,CAAC,CAEV,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}