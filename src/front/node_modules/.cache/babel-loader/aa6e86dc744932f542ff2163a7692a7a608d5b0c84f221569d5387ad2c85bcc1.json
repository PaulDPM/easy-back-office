{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/galadmin/galadmin/src/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from\"react\";import axios from\"axios\";import OutsideClickHandler from\"./OutsideClickHandler\";import{ConfigContext}from'../contexts/ConfigContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default(function(_ref){var _view$customActions,_view$customActions2;var viewIndex=_ref.viewIndex,selectedRecordIds=_ref.selectedRecordIds,refreshData=_ref.refreshData;var config=useContext(ConfigContext);var view=config.views[viewIndex];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),bulkActionsOpened=_useState2[0],setBulkActionsOpened=_useState2[1];var bulkDelete=function bulkDelete(){window.swal({title:\"Êtes-vous sûr ?\",text:\"Une fois la suppression confirmée, il ne sera pas possible de revenir en arrière.\",buttons:[\"Annuler\",\"Oui\"],dangerMode:true}).then(function(willDelete){if(willDelete){axios.post(\"deleteRecords\",{viewIndex:viewIndex,primaryValues:selectedRecordIds}).then(function(){refreshData();}).catch(function(){window.swal({title:\"Erreur\",text:\"Suppression impossible\",dangerMode:true});});}});};var bulkCustomAction=function bulkCustomAction(actionIndex){return function(){setBulkActionsOpened(false);axios.post(\"customAction\",{viewIndex:viewIndex,actionIndex:actionIndex,selectedRecordIds:selectedRecordIds}).then(function(response){if(response.data.message){alert(response.data.message);}refreshData();}).catch(function(){window.swal({title:\"Erreur\",text:\"L'action a échoué\",dangerMode:true});});};};return!config.hideMultiselect&&(view.canDelete!==false||((_view$customActions=view.customActions)===null||_view$customActions===void 0?void 0:_view$customActions.length)>0)?/*#__PURE__*/_jsx(OutsideClickHandler,{onOutsideClick:function onOutsideClick(){return setBulkActionsOpened(false);},children:/*#__PURE__*/_jsxs(\"div\",{class:\"actionButtonsContainer\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"button openBulkActionsButton\",onClick:function onClick(){return setBulkActionsOpened(!bulkActionsOpened);},children:\"Actions\"}),bulkActionsOpened?/*#__PURE__*/_jsxs(\"div\",{class:\"bulkActions\",children:[(_view$customActions2=view.customActions)===null||_view$customActions2===void 0?void 0:_view$customActions2.map(function(action,index){return/*#__PURE__*/_jsx(\"div\",{class:\"action recordAction\",onClick:bulkCustomAction(index),children:action.label});}),view.canDelete!==false?/*#__PURE__*/_jsx(\"div\",{class:\"action recordAction red\",onClick:bulkDelete,children:\"Supprimer\"}):null]}):null]})}):null;});","map":{"version":3,"names":["useContext","useState","axios","OutsideClickHandler","ConfigContext","jsx","_jsx","jsxs","_jsxs","_ref","_view$customActions","_view$customActions2","viewIndex","selectedRecordIds","refreshData","config","view","views","_useState","_useState2","_slicedToArray","bulkActionsOpened","setBulkActionsOpened","bulkDelete","window","swal","title","text","buttons","dangerMode","then","willDelete","post","primaryValues","catch","bulkCustomAction","actionIndex","response","data","message","alert","hideMultiselect","canDelete","customActions","length","onOutsideClick","children","class","onClick","map","action","index","label"],"sources":["/home/runner/work/galadmin/galadmin/src/front/src/components/BulkActionsButton.js"],"sourcesContent":["import { useContext, useState } from \"react\"\nimport axios from \"axios\";\nimport OutsideClickHandler from \"./OutsideClickHandler\"\nimport { ConfigContext } from '../contexts/ConfigContext'\n\nexport default ({ viewIndex, selectedRecordIds, refreshData }) => {\n    const config = useContext(ConfigContext)\n    const view = config.views[viewIndex]\n    const [bulkActionsOpened, setBulkActionsOpened] = useState(false)\n\n    const bulkDelete = () => {\n        window.swal({\n            title: \"Êtes-vous sûr ?\",\n            text: \"Une fois la suppression confirmée, il ne sera pas possible de revenir en arrière.\",\n            buttons: [\"Annuler\", \"Oui\"],\n            dangerMode: true\n        }).then((willDelete) => {\n            if (willDelete) {\n                axios.post(\"deleteRecords\", {\n                    viewIndex,\n                    primaryValues: selectedRecordIds\n                }).then(function () {\n                    refreshData()\n                }).catch(function () {\n                    window.swal({\n                        title: \"Erreur\",\n                        text: \"Suppression impossible\",\n                        dangerMode: true\n                    })\n                });\n            }\n        });\n    }\n\n    const bulkCustomAction = (actionIndex) => () => {\n        setBulkActionsOpened(false)\n        axios.post(\"customAction\", {\n            viewIndex,\n            actionIndex,\n            selectedRecordIds\n        }).then(function (response) {\n            if (response.data.message) {\n                alert(response.data.message)\n            }\n            refreshData()\n        }).catch(function () {\n            window.swal({\n                title: \"Erreur\",\n                text: \"L'action a échoué\",\n                dangerMode: true\n            })\n        });\n    }\n\n    return !config.hideMultiselect && (view.canDelete !== false || view.customActions?.length > 0) ? (\n        <OutsideClickHandler onOutsideClick={() => setBulkActionsOpened(false)}>\n            <div class=\"actionButtonsContainer\">\n                <div class=\"button openBulkActionsButton\" onClick={() => setBulkActionsOpened(!bulkActionsOpened)}>Actions</div>\n                {bulkActionsOpened ? <div class=\"bulkActions\">\n                    {view.customActions?.map((action, index) => (\n                        <div class=\"action recordAction\" onClick={bulkCustomAction(index)}>{action.label}</div>\n                    ))}\n                    {view.canDelete !== false ? <div class=\"action recordAction red\" onClick={bulkDelete}>Supprimer</div> : null}\n                </div> : null}\n            </div>\n        </OutsideClickHandler>\n    ) : null\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}