{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/galadmin/galadmin/src/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useContext}from\"react\";import axios from\"axios\";import{useParams,Link}from\"react-router-dom\";import getFormattedValue from\"../utils/getFormattedValue\";import ActionsButton from\"../components/ActionsButton\";import BackButton from\"../components/BackButton\";import DownloadTablePanelButton from\"../components/DownloadTablePanelButton\";import TablePanel from\"../components/panels/TablePanel\";import GalleryPanel from\"../components/panels/GalleryPanel\";import MapPanel from\"../components/panels/MapPanel\";import{ConfigContext}from'../contexts/ConfigContext';import ChatPanel from\"../components/panels/ChatPanel\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default(function(){var _view$columns;var config=useContext(ConfigContext);var _useParams=useParams(),viewIndex=_useParams.viewIndex,recordId=_useParams.recordId;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),record=_useState2[0],setRecord=_useState2[1];var view=config.views[viewIndex];var filteredColumns=(_view$columns=view.columns)===null||_view$columns===void 0?void 0:_view$columns.filter(function(x){return!x.hidden;});useEffect(function(){refreshData();},[viewIndex,recordId]);var refreshData=function refreshData(){axios.get(\"/record\",{params:{viewIndex:viewIndex,recordId:recordId}}).then(function(response){setRecord(response.data);});};return/*#__PURE__*/_jsxs(\"div\",{class:\"view backgroundBlue\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"viewHeader\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"viewTitle\",children:view.label}),/*#__PURE__*/_jsxs(\"div\",{class:\"viewHeaderActions\",children:[/*#__PURE__*/_jsx(BackButton,{}),/*#__PURE__*/_jsx(ActionsButton,{viewIndex:viewIndex,record:record,refreshData:refreshData}),view.canEdit!==false?/*#__PURE__*/_jsx(Link,{to:\"/editRecord/\".concat(viewIndex,\"/\").concat(recordId),children:/*#__PURE__*/_jsx(\"div\",{class:\"button greenButton recordAction\",children:\"Modifier\"})}):null]})]}),/*#__PURE__*/_jsx(\"div\",{class:\"paddedView\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"showContainer\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"panel detailsPanel\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"panelTitle\",children:\"D\\xE9tails\"}),record?filteredColumns.map(function(column,index){return/*#__PURE__*/_jsxs(\"div\",{class:\"showRecordField\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"formLabel\",children:column.label}),/*#__PURE__*/_jsx(\"div\",{class:\"formValue\",children:getFormattedValue(column,record,config,false)||\"-\"})]},index);}):null]}),view.recordViewPanels&&record?/*#__PURE__*/_jsx(\"div\",{class:\"recordViewPanels\",children:view.recordViewPanels.map(function(panel,index){return/*#__PURE__*/_jsxs(\"div\",{class:\"panel\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"panelHeader\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"viewTitle\",children:panel.label}),/*#__PURE__*/_jsxs(\"div\",{class:\"viewHeaderActions\",children:[panel.folded?/*#__PURE__*/_jsx(\"div\",{class:\"button smallButton unfoldPanel\",children:\"Afficher\"}):null,panel.canCreate?/*#__PURE__*/_jsx(Link,{to:\"/createRecord/\".concat(viewIndex,\"/\").concat(index,\"/\").concat(recordId),children:/*#__PURE__*/_jsx(\"div\",{class:\"plusButton\",children:/*#__PURE__*/_jsx(\"i\",{class:\"fa fa-plus\"})})}):null,panel.canDownload&&panel.type===\"table\"?/*#__PURE__*/_jsx(DownloadTablePanelButton,{record:record,panel:panel}):null]})]}),panel.type===\"table\"?/*#__PURE__*/_jsx(TablePanel,{record:record,panel:panel,view:view,index:index}):null,panel.type===\"gallery\"?/*#__PURE__*/_jsx(GalleryPanel,{record:record,panel:panel,view:view,index:index}):null,panel.type===\"map\"?/*#__PURE__*/_jsx(MapPanel,{record:record,panel:panel,view:view,index:index}):null,panel.type===\"chat\"?/*#__PURE__*/_jsx(ChatPanel,{record:record,panel:panel,view:view,index:index}):null]},index);})}):null]})})]});});","map":{"version":3,"names":["useState","useEffect","useContext","axios","useParams","Link","getFormattedValue","ActionsButton","BackButton","DownloadTablePanelButton","TablePanel","GalleryPanel","MapPanel","ConfigContext","ChatPanel","jsx","_jsx","jsxs","_jsxs","_view$columns","config","_useParams","viewIndex","recordId","_useState","_useState2","_slicedToArray","record","setRecord","view","views","filteredColumns","columns","filter","x","hidden","refreshData","get","params","then","response","data","class","children","label","canEdit","to","concat","map","column","index","recordViewPanels","panel","folded","canCreate","canDownload","type"],"sources":["/home/runner/work/galadmin/galadmin/src/front/src/pages/Record.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\"\nimport axios from \"axios\";\nimport {\n    useParams,\n    Link,\n} from \"react-router-dom\";\nimport getFormattedValue from \"../utils/getFormattedValue\"\nimport ActionsButton from \"../components/ActionsButton\"\nimport BackButton from \"../components/BackButton\"\nimport DownloadTablePanelButton from \"../components/DownloadTablePanelButton\"\nimport TablePanel from \"../components/panels/TablePanel\"\nimport GalleryPanel from \"../components/panels/GalleryPanel\"\nimport MapPanel from \"../components/panels/MapPanel\"\nimport { ConfigContext } from '../contexts/ConfigContext'\nimport ChatPanel from \"../components/panels/ChatPanel\";\n\nexport default () => {\n    const config = useContext(ConfigContext)\n    const { viewIndex, recordId } = useParams();\n    const [record, setRecord] = useState(null);\n\n    const view = config.views[viewIndex]\n    const filteredColumns = view.columns?.filter(x => !x.hidden)\n\n    useEffect(() => {\n        refreshData()\n    }, [viewIndex, recordId]);\n\n    const refreshData = () => {\n        axios.get(\"/record\", {\n            params: {\n                viewIndex,\n                recordId\n            }\n        }).then((response) => {\n            setRecord(response.data);\n        });\n    }\n\n    return (\n        <div class=\"view backgroundBlue\">\n            <div class=\"viewHeader\">\n                <div class=\"viewTitle\">{view.label}</div>\n                <div class=\"viewHeaderActions\">\n                    <BackButton />\n                    <ActionsButton viewIndex={viewIndex} record={record} refreshData={refreshData} />\n                    {view.canEdit !== false ? (\n                        <Link to={`/editRecord/${viewIndex}/${recordId}`}>\n                            <div class=\"button greenButton recordAction\">Modifier</div>\n                        </Link>\n                    ) : null}\n                </div>\n            </div>\n            <div class=\"paddedView\">\n                <div class=\"showContainer\">\n                    <div class='panel detailsPanel'>\n                        <div class='panelTitle'>DÃ©tails</div>\n                        {record ?\n                            filteredColumns.map((column, index) => (\n                                <div class='showRecordField' key={index}>\n                                    <div class='formLabel'>{column.label}</div>\n                                    <div class='formValue'>{getFormattedValue(column, record, config, false) || \"-\"}</div>\n                                </div>\n                            ))\n                            : null}\n                    </div>\n                    {view.recordViewPanels && record ? (\n                        <div class='recordViewPanels'>\n                            {view.recordViewPanels.map((panel, index) => (\n                                <div class='panel' key={index}>\n                                    <div class='panelHeader'>\n                                        <div class='viewTitle'>{panel.label}</div>\n                                        <div class='viewHeaderActions'>\n                                            {panel.folded ? <div class='button smallButton unfoldPanel'>Afficher</div> : null}\n                                            {panel.canCreate ? <Link to={`/createRecord/${viewIndex}/${index}/${recordId}`}><div class='plusButton'><i class='fa fa-plus'></i></div></Link> : null}\n                                            {panel.canDownload && panel.type === \"table\" ? <DownloadTablePanelButton record={record} panel={panel} /> : null}\n                                        </div>\n                                    </div>\n                                    {panel.type === \"table\" ? <TablePanel record={record} panel={panel} view={view} index={index} /> : null}\n                                    {panel.type === \"gallery\" ? <GalleryPanel record={record} panel={panel} view={view} index={index} /> : null}\n                                    {panel.type === \"map\" ? <MapPanel record={record} panel={panel} view={view} index={index} /> : null}\n                                    {panel.type === \"chat\" ? <ChatPanel record={record} panel={panel} view={view} index={index} /> : null}\n                                </div>\n                            ))}\n                        </div>\n                    ) : null}\n                </div>\n            </div>\n        </div>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}